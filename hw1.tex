\documentclass[12pt]{article}
\usepackage{url,hyperref,amsmath,setspace,amssymb,amsthm,amsfonts}


\setlength{\oddsidemargin}{.25in}
\setlength{\evensidemargin}{.25in}
\setlength{\textwidth}{6.25in}
\setlength{\topmargin}{-0.4in}
\setlength{\textheight}{8.5in}

\newcommand{\heading}[5]{
   \renewcommand{\thepage}{#1-\arabic{page}}
   \noindent
   \begin{center}
   \framebox[\textwidth]{
     \begin{minipage}{0.9\textwidth} \onehalfspacing
       {\bf CS 290G -- Introduction to Modern Cryptography} \hfill #2

       {\centering \Large #5
       
       }\medskip

       {\it #3 \hfill #4}
     \end{minipage}
   }
   \end{center}
}

\newcommand{\handout}[3]{\heading{#1}{#2}{Instructor:
Stefano Tessaro}{Student: Shiyu Ji}{#3}}

\setlength{\parindent}{0in}

\newcommand{\eqdef}{\stackrel{def}{=}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\bits}{\{0,1\}}
\newcommand{\inr}{\in_{\mbox{\tiny R}}}
%\newcommand{\getsr}{\gets_{\mbox{\tiny R}}}
\newcommand{\getsr}{\stackrel{\$}{\gets}}
\newcommand{\st}{\mbox{ s.t. }}
\newcommand{\etal}{{\it et al }}
\newcommand{\into}{\rightarrow}

\newcommand{\Ex}{\mathbb{E}}
\newcommand{\e}{\epsilon}
\newcommand{\ee}{\varepsilon}
\newcommand{\ceil}[1]{{\lceil{#1}\rceil}}
\newcommand{\floor}[1]{{\lfloor{#1}\rfloor}}
\newcommand{\angles}[1]{\langle #1 \rangle}
\newcommand{\Com}{{\sf Com}}
\newcommand{\desc}{{\sf desc}}

\newcommand{\rightstep}[1]{%
$\underrightarrow{\quad #1 \quad}$ }

\newcommand{\leftstep}[1]{%
$\underleftarrow{\quad #1 \quad}$ }
\newcommand{\Adv}{\textsf{Adv}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Theorems & Definitions


\newtheorem{theorem}{Theorem}[section]

\newtheorem{claim}[theorem]{Claim}
\newtheorem{subclaim}{Claim}[theorem]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{observation}[theorem]{Observation}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{construction}[theorem]{Construction}
\newtheorem{example}[theorem]{Example}
\newtheorem{counterexample}[theorem]{Counterexample}
\newtheorem{algorithm1}[theorem]{Algorithm}
\newtheorem{protocol}[theorem]{Protocol}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{fact}[theorem]{Fact}

%\bibliographystyle{plain}

\begin{document}
\handout{1}{Due: Jan 29, 2016}{Homework 1}
\section{Task 1 - Negligible Functions}
Recall that a function $f : \N \mapsto \R_{\geq 0}$ is \emph{negligible} if for all $c\in\N$, there exists $n_c$ such that $f(n)\leq n^{-c}$ for all $n\geq n_c$.

{\bf a) [Points: 6]} Which ones of the following functions are negligible, and which ones are not? Prove your claim!
$$f_1(n) = 2^{-n}, \quad f_3(n) = 2^{-\log n}, \quad f_5(n) = n^{-\log n},$$
$$f_2(n) = n^{-100}, \quad f_4(n) = 2^{-\log^2 n}, \quad f_6(n) = (-1)^n.$$

{\bf Solution}: 
\begin{itemize}
\item $f_1$ is negligible. For all $c\in\N$, let $n_c = 2^{2c}$. Note that $2c^2-4^c<0$ for any $c\in\N$. Hence for any $n\geq n_c =2^{2c}$,
$$n^c\cdot 2^{-n} \leq n_c^c\cdot 2^{-n_c} = 2^{2c^2}\cdot 2^{-2^{2c}} = 2^{2c^2-4^c} < 1.$$
The first inequality holds since the function $h(n)=n^c\cdot 2^{-n}$ decreases over $n\geq 2^c$. It is easy to see $\log h(n) = c\log n -n$ decreases over $n\geq 2^c$, since $(\log h(n))' = c/n-1<0$ if $n\geq 2^c$. Thus we have for any $n\geq n_c =2^{2c}$, $2^{-n} < n^{-c}$.

\item $f_2$ is \emph{not} negligible. Let $c=1000$. There are infinite $n$'s s.t. $n^{-100} > n^{-1000}$. In fact, this holds for every $n>1$.

\item $f_3$ is \emph{not} negligible. Note that $f_3(n) = 2^{-\log n} = 1/n$. Let $c=2$. For any $n>1$, we have $1/n > n^{-c} = 1/(n^2)$.

\item $f_4$ is negligible. Note that $f_4(n) = 2^{-\log^2 n} = n^{-\log n}$. For all $c\in\N$, let $n_c = 2^c$. Then for any $n\geq n_c = 2^c$,
$$f_4(n) = n^{-\log n} \leq n^{-\log n_c} = n^{-\log 2^c} = n^{-c}.$$

\item $f_5$ is negligible, since $f_5(n) = f_4(n)$, which has been shown to be negligible.

\item $f_6$ is \emph{not} negligible. Let $c=1$. Note that when $n$ takes any even number larger than 1, we have $1/n < 1 = (-1)^n$. Hence there are infinite $n$'s s.t. $(-1)^n > n^{-c} = 1/n$.
\end{itemize}

{\bf b) [Points: 6]} Show that for any two negligible functions $f, g$, and any polynomial $p$ which is non-negative (i.e., $p(n)\geq 0$ on all $n\in\N$) the following functions are negligible:
$$n \mapsto f(n)+g(n), \quad n \mapsto p(f(n)) \textrm{ where $p$ has no constant term},$$
$$n \mapsto f(n)\cdot g(n), \quad n \mapsto p(n)\cdot f(n) \textrm{ for a polynomial $p(n)$}.$$

{\bf Solution}:
\begin{itemize}
\item $f(n)+g(n)$ is negligible.
\begin{proof}
Since $f$ and $g$ are negligible, for any $c+1\in \N$, there exists $n_{c+1,f}$ s.t. for any $n\geq n_{c+1,f}$, $f(n) \leq n^{-(c+1)}$, and there exists $n_{c+1,g}$ s.t. for any $n\geq n_{c+1,g}$, $g(n) \leq n^{-(c+1)}$. Thus, for any $n\geq \max\{n_{c+1,f}, n_{c+1,g}\}$, we have $f(n) \leq n^{-(c+1)}$ and $g(n) \leq n^{-(c+1)}$. Now given any $c\in\N$, let $n_c = \max\{3, n_{c+1,f}, n_{c+1,g}\}$. Then for any $n\geq n_c$, we have $f(n)+g(n) \leq 2n^{-(c+1)} = \frac{2}{n}n^{-c} < n^{-c}$, which satisfies the definition of a negligible function.
\end{proof}

\item For a \emph{non-negative} polynomial $p(n)$ with no constant term, $p(f(n))$ is negligible.
\begin{proof}
Suppose the degree of $p(n)$ is $d$, and $p(n) = \sum_{k=1}^d a_kn^k$, where each $a_k\in\R$. 
%Then $a_d\geq 0$; otherwise, $p(n)$ cannot be non-negative. 
$$\forall x\in [0,1], p(x) = \sum_{k=1}^d a_kx^k \leq \sum_{k=1}^d |a_k|x^k \leq \sum_{k=1}^d |a_k|x$$
Define the coefficient magnitude sum of $p$: $S_p = \sum_{k=1}^d |a_k|$. Then for all $f(n)\in[0,1]$, $p(f(n)) \leq S_p \cdot f(n)$.
On the other hand, since $f(n)$ is negligible, for any $c\in\N$, there exists $n_{c,f}$ s.t. for any $n\geq n_{c,f}$, we have $f(n)\leq n^{-c}$. 
For all $c\in\N$, let $n_c = \max\{\lceil S_p \rceil+1, n_{c+1,f}, 2, n_{1,f}\}$. Then for any $n\geq n_c$, we have $f(n)\leq 1/n<1$ and thus
$$p(f(n)) \leq S_p \cdot f(n) \leq S_p \cdot n^{-(c+1)} = \frac{S_p}{n}n^{-c} < n^{-c},$$
which satisfies the definition of a negligible function.
\end{proof}

\item $f(n)\cdot g(n)$ is negligible.
\begin{proof}
Since $f$ and $g$ are negligible, for any $c\in \N$, there exists $n_{c,f}$ s.t. for any $n\geq n_{c,f}$, $f(n) \leq n^{-c}$, and there exists $n_{c,g}$ s.t. for any $n\geq n_{c,g}$, $g(n) \leq n^{-c}$. Let $n_c = \max\{n_{c,f}, n_{c,g}\}$. Then for any $n\geq n_c$, we have $f(n) \leq n^{-c}$ and $g(n) \leq n^{-c}$. Hence $f(n)\cdot g(n) \leq n^{-2c} \leq n^{-c}$, which satisfies the definition of a negligible function.
\end{proof}

\item For a \emph{non-negative} polynomial $p(n)$, $p(n)\cdot f(n)$ is negligible.
\begin{proof}
Suppose the degree of $p(n)$ is $d$, and $p(n) = \sum_{k=0}^d a_kn^k$, where each $a_k\in\R$.
Since $p(n)$ is non-negative, we have $a_d \geq 0$. Otherwise, a sufficiently large $n$ can give negative $p(n)$, which is dominated by the term $a_dn^d$.
Define the maximum coefficient: $a \eqdef \max_{k=0}^d \{a_k\} \geq a_d \geq 0$. Note that 
$$p(n) = \sum_{k=0}^d a_kn^k \leq a \sum_{k=0}^d n^k = a \frac{n^{d+1}-1}{n-1} \leq a \frac{n^{d+1}}{n-1}.$$
When $n-1>a$, we have $p(n) < n^{d+1}$. 

Since $f(n)$ is negligible, for any $c\in\N$, there exists $n_{c,f}$ s.t. for any $n\geq n_{c,f}$, $f(n) \leq n^{-c}$. 
For any $c\in\N$, let $n_c = \max\{a+2, n_{c+d+1,f}\}$. Then for any $n\geq n_c$, we have
$$p(n)\cdot f(n) < n^{d+1} f(n) \leq n^{d+1} n^{-(c+d+1)} = n^{-c},$$
which satisfies the definition of a negligible function.
\end{proof}
\end{itemize}

\section{Task 2 - One-Way Functions}
Let $f, g : \bits^\lambda \mapsto \bits^\lambda$ be both one-way functions. Which of the following statements
are true and which ones are false? Formally justify your claims â€“ i.e., either with a proof
of one-wayness or a counterexample.

{\bf a) [Points: 2]} $x \mapsto f(x) \oplus g(x)$, where $\oplus$ denotes bitwise xor.

{\bf Claim}: $x \mapsto f(x) \oplus g(x)$ is \emph{not} one-way.

{\bf Counterexample}:
Consider $f(x) = g(x)$, i.e., $f$ and $g$ are the same one-way function. Then we have
$$\forall x\in\bits^\lambda, f(x) \oplus g(x) = f(x) \oplus f(x) = 0^\lambda.$$
Given any $h(x) \eqdef f(x) \oplus g(x)$, the adversary just chooses $x' \getsr \bits^\lambda$ and inverts $h(x)$ (i.e. $h(x')=h(x)$) with advantage 1.

{\bf b) [Points: 2]} $(x, y) \mapsto f(x) || g(y)$.

{\bf Claim}: $(x, y) \mapsto f(x) || g(y)$ is one-way.
\begin{proof}
Assume by contradiction $h(x, y) \eqdef f(x) || g(y)$ is not one-way. Then there exists a PPT adversary $A$ s.t. the advantage $\epsilon(\lambda) \eqdef \Adv_{h,\lambda}^{owf}(A)$ is non-negligible. We are going to build an algorithm $A'$ and argue that $A'$ can invert $f(x)$ with non-negligible advantage $\Adv_{f,\lambda}^{owf}(A')$. Given input $z \in\bits^{\lambda}$, the construction of $A'$ is given as following:
\begin{quote}
Adversary $A' (z)$:
\begin{enumerate}
\item $y \getsr \bits^\lambda$.
\item $(x', y') \getsr A(z || g(y))$.
\item {\bf output} $x'$.
\end{enumerate}
\end{quote}
We can estimate the advantage of $A'$:
$$
\begin{aligned}
& \Adv_{f,\lambda}^{owf}(A') \\
=& \Pr[x\getsr \bits^\lambda, x' \getsr A'(f(x)) : f(x')=f(x)] \\
=& \Pr[x\getsr \bits^\lambda, y\getsr \bits^\lambda, (x', y') \getsr A(f(x) || g(y)) : f(x')=f(x)] \\
\geq & \Pr[x\getsr \bits^\lambda, y\getsr \bits^\lambda, (x', y') \getsr A(f(x) || g(y)) : f(x')=f(x), g(y')=g(y)] \\
=& \Pr[x\getsr \bits^\lambda, y\getsr \bits^\lambda, (x', y') \getsr A(h(x, y)) : h(x', y')=h(x, y)] \\
=& \Adv_{h,\lambda}^{owf}(A) = \epsilon(\lambda).
\end{aligned}
$$
Hence $A'$ has a non-negligible advantage.
\end{proof}

{\bf c) [Points: 2]} $x \mapsto f(g(x))$.

{\bf Claim}: $x \mapsto f(g(x))$ is \emph{not} one-way.

{\bf Counterexample}: Suppose $h, j : \bits^\lambda \mapsto \bits^\lambda$ are one-way functions (not permutations) and w.l.o.g $0^\lambda$ is not in the range of $j$. We construct two functions $f,g : \bits^{2\lambda} \mapsto \bits^{2\lambda}$ as following, given any inputs $x, y \in \bits^\lambda$:
$$g(x,y) \eqdef h(x) || h(x).$$
$$f(x,y) \eqdef
\begin{cases}
0^{2\lambda} & \textrm{if $x=y$,} \\
(j(x),j(y)) & \textrm{otherwise.}
\end{cases}$$
Apparently $f(g(z)) = 0^{2\lambda}$ for all $z\in\bits^{2\lambda}$. Thus $h\eqdef f\circ g$ is \emph{not} one-way over $\bits^{2\lambda}$.
We claim that both $f$ and $g$ are one-way.
\begin{lemma}
Given one way function $h : \bits^\lambda \mapsto \bits^\lambda$, $g(x,y) \eqdef h(x) || h(x)$ is also one-way.
\end{lemma}
\begin{proof}
Assume by contradiction $g$ is not one-way. Then there exists a PPT adversary $A$ s.t. the advantage $\epsilon(\lambda) \eqdef \Adv_{g,\lambda}^{owf}(A)$ is non-negligible. It suffices to build an algorithm $A'$ s.t. the advantage $\Adv_{h,\lambda}^{owf}(A')$ is also non-negligible. Given any input $y=h(x)$, we give the construction of $A'$ as following:
\begin{quote}
Adversary $A' (y)$:
\begin{enumerate}
\item $(x', y') \getsr A(y || y)$.
\item {\bf output} $x'$.
\end{enumerate}
\end{quote}
We can estimate the advantage of $A'$:
$$
\begin{aligned}
&\Adv_{h,\lambda}^{owf}(A') = \Pr[x\getsr \bits^\lambda, x' \getsr A'(h(x)) : h(x')=h(x)] \\
=& \Pr[(x,y)\getsr \bits^{2\lambda}, x' \getsr A'(h(x)) : h(x')=h(x)] \\
=& \Pr[(x,y)\getsr \bits^{2\lambda}, (x', y') \getsr A(h(x) || h(x)) : h(x')=h(x)] \\
=& \Pr[(x,y)\getsr \bits^{2\lambda}, (x', y') \getsr A(h(x) || h(x)) : h(x')||h(x') = h(x)||h(x)] \\
=& \Pr[(x,y)\getsr \bits^{2\lambda}, (x', y') \getsr A(g(x, y)) : g(x', y') = g(x, y)] \\
=& \Adv_{g,\lambda}^{owf}(A) = \epsilon(\lambda),
\end{aligned}
$$
which is also non-negligible.
\end{proof}

\begin{lemma}
Given one way function $j : \bits^\lambda \mapsto \bits^\lambda$ s.t. $0^\lambda \not\in \mathrm{range}(j)$, the function $f : \bits^{2\lambda} \mapsto \bits^{2\lambda}$ given by
$$f(x,y) \eqdef
\begin{cases}
0^{2\lambda} & \textrm{if $x=y$,} \\
(j(x),j(y)) & \textrm{otherwise.}
\end{cases}$$
is also one-way.
\end{lemma}
\begin{proof}
Assume by contradiction $f(x,y)$ is not one-way. Then there exists a PPT adversary $A$ s.t. the advantage $\epsilon(\lambda) = \Adv_{f,\lambda}^{owf}(A)$ is non-negligible. It suffices to build an algorithm $A'$ s.t. the advantage $\Adv_{j,\lambda}^{owf}(A')$ is also non-negligible. Given any input $y_1 = j(x_1)$, we give the construction of $A'$ as following:
\begin{quote}
Adversary $A' (y_1)$:
\begin{enumerate}
\item $x_2 \getsr \bits^\lambda$.
\item $(x_1',x_2') \getsr A(y_1,j(x_2))$.
\item {\bf output} $x_1'$.
\end{enumerate}
\end{quote} 
We can estimate the advantage of $A'$:
$$
\begin{aligned}
&\Adv_{j,\lambda}^{owf}(A') \\
=& \Pr[x_1 \getsr \bits^\lambda, x_1' \getsr A'(j(x_1)) : j(x_1') = j(x_1)] \\
=& \Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(j(x_1),j(x_2)) : j(x_1') = j(x_1)] \\
=& \Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(j(x_1),j(x_2)) : x_1=x_2, j(x_1') = j(x_1)] \\
&+\Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(j(x_1),j(x_2)) : x_1\not=x_2, j(x_1') = j(x_1)].
\end{aligned}
$$
Note that the first term of probability 
$$\Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(j(x_1),j(x_2)) : x_1=x_2, j(x_1') = j(x_1)]$$
$$\leq \Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(j(x_1),j(x_2)) : x_1=x_2] = 2^{-\lambda},$$
is negligible. From Task 1, it suffices to show that the second term of probability
$$\Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(j(x_1),j(x_2)) : x_1\not=x_2, j(x_1') = j(x_1)]$$
is non-negligible.
By conditional probability,
$$
\begin{aligned}
&\Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(j(x_1),j(x_2)) : x_1\not=x_2, j(x_1') = j(x_1)]\\
=&\Pr[(x_1, x_2) \getsr \bits^{2\lambda}: x_1\not=x_2]\Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(j(x_1),j(x_2)), \\
&x_1\not=x_2 : j(x_1') = j(x_1)]\\
=&(1-2^{-\lambda})\Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(j(x_1),j(x_2)), x_1\not=x_2 : j(x_1') = j(x_1)].
\end{aligned}
$$
Similarly by Task 1, we only need to show that the probability
\begin{equation}
\label{eq:1}
\Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(j(x_1),j(x_2)), x_1\not=x_2 : j(x_1') = j(x_1)]
\end{equation}
is non-negligible. On the other hand, again by using conditional probabilities,
$$
\begin{aligned}
&\epsilon(\lambda) = \Adv_{f,\lambda}^{owf}(A) \\
=&\Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(f(x_1,x_2)) : f(x_1',x_2') = f(x_1,x_2)]\\
=&(1-2^{-\lambda})\Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(f(x_1,x_2)), x_1\not=x_2: f(x_1',x_2') = f(x_1,x_2)]\\
&+2^{-\lambda}\Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(f(x_1,x_2)), x_1=x_2: f(x_1',x_2') = f(x_1,x_2)].
\end{aligned}
$$
Define 
$$\epsilon'(\lambda) \eqdef \Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(f(x_1,x_2)), x_1\not=x_2: f(x_1',x_2') = f(x_1,x_2)],$$
which is non-negligible. Since if $x_1\not=x_2$, we have $f(x_1,x_2)\not= 0^{2\lambda}$, and thus $f(x_1,x_2) = f(x_1',x_2') \not=0^{2\lambda}$ implies $j(x_1)=j(x_1')$. Hence we can show the probability in (\ref{eq:1}) is non-negligible.
$$
\begin{aligned}
&\Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(j(x_1),j(x_2)), x_1\not=x_2 : j(x_1') = j(x_1)] \\
=& \Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(f(x_1,x_2)), x_1\not=x_2 : j(x_1') = j(x_1)] \\
\geq & \Pr[(x_1, x_2) \getsr \bits^{2\lambda}, (x_1', x_2') \getsr A(f(x_1,x_2)), x_1\not=x_2 : f(x_1,x_2) = f(x_1',x_2')] \\
=& \epsilon'(\lambda).
\end{aligned}$$
\end{proof}

\section{Task 3 - Hard-Core Predicates}
Let $f : \bits^\lambda \mapsto \bits^{\lambda'}$ be a permutation family, and let $P : \bits^\lambda \mapsto \bits$ be a family of predicates. Then, recall that $P$ is a hardcore predicate for $f$ if for all PPT $A$, we have that
$$\Adv_{f,P,\lambda}^{pred}(A) = 2 \left| \Pr[x\getsr\bits^\lambda : A(f(x)) = P(x)] -\frac{1}{2}\right|$$
is negligible.

{\bf a) [Points: 8]} Prove, giving an explicit reduction, that if $f : \bits^\lambda \mapsto \bits^{\lambda'}$ is a \emph{permutation}, and there exists some hardcore predicate $P$ for $f$, then $f$ must be one way.
\begin{proof}
Assume by contradiction $f$ is not one-way. Then there exists a PPT adversary $A$ s.t. the advantage $\Adv_{f,\lambda}^{owf}(A)$ is non-negligible. It suffices to build a distinguisher $D$ s.t. the advantage $\Adv_{f,P,\lambda}^{pred}(D)$ is also non-negligible. Given any input $y=f(x)$, we give the construction of $D$ as following:
\begin{quote}
Distinguisher $D(y)$:
\begin{enumerate}
\item $x' \getsr A(y)$.
\item {\bf if} $f(x') = y$ {\bf then output} $P(x')$.
\item {\bf else} $r\getsr\bits$, and {\bf output} $r$. 
\end{enumerate}
\end{quote}
Now we can compute the advantage of $D$:
$$
\begin{aligned}
&\Adv_{f,P,\lambda}^{pred}(D) = 2 \left| \Pr[x\getsr\bits^\lambda : D(f(x)) = P(x)] -\frac{1}{2}\right| \\
=& 2 \bigg| \Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)) : f(x')=f(x), D(f(x)) = P(x)] \\
&+ \Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)) : f(x')\not=f(x), D(f(x)) = P(x)] -\frac{1}{2}\bigg|.
\end{aligned}
$$
We can compute both the terms of probability.
$$
\begin{aligned}
&\Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)) : f(x')=f(x), D(f(x)) = P(x)] \\
&+\Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)) : f(x')\not=f(x), D(f(x)) = P(x)] \\
=&\Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)) : f(x')=f(x)]\\
&\cdot\Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)), f(x')=f(x): P(x') = P(x)] \\
&+\Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)) : f(x')\not=f(x)]\\
&\cdot\Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)), f(x')\not=f(x), r\getsr\bits: r = P(x)] \\
\end{aligned}
$$
Note that $\Adv_{f,\lambda}^{owf}(A) \eqdef \Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)) : f(x')=f(x)]$, and since $f$ is one-to-one, $f(x')=f(x)$ iff $x'=x$. Hence we have
$$
\begin{aligned}
&\Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)) : f(x')=f(x), D(f(x)) = P(x)] \\
&+\Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)) : f(x')\not=f(x), D(f(x)) = P(x)] \\
=&\Adv_{f,\lambda}^{owf}(A)\cdot\Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)), x'=x: P(x') = P(x)] \\
&+(1-\Adv_{f,\lambda}^{owf}(A))\cdot\Pr[x\getsr\bits^\lambda, x'\getsr A(f(x)), f(x')\not=f(x), r\getsr\bits: r = P(x)] \\
=&\Adv_{f,\lambda}^{owf}(A)\cdot 1 + (1-\Adv_{f,\lambda}^{owf}(A))/2 = \frac{1}{2} + \frac{1}{2}\Adv_{f,\lambda}^{owf}(A).
\end{aligned}
$$
Thus
$$\Adv_{f,P,\lambda}^{pred}(D) = 2\left| \frac{1}{2} + \frac{1}{2}\Adv_{f,\lambda}^{owf}(A)-\frac{1}{2} \right| = \Adv_{f,\lambda}^{owf}(A),$$
which is non-negligible.
\end{proof}

{\bf b) [Points: 2]} Why is it necessary in a) that $f$ is a permutation? Is the statement true for
general $f$? Justify your answer!

{\bf Claim}: The statement is not true for general $f$.

{\bf Counterexample}: Suppose $f : \bits^\lambda \mapsto \bits$ is defined by $f(x) = 0$ for any $x\in\bits^\lambda$. Apparently $f$ is not one-way, but we claim the bitwise xor $\oplus_i x_i$ is a hardcore predicate of $f$. Note that the predicate $\oplus_i x_i$ is uniformly distributed over $\bits$ if $x\getsr\bits^\lambda$. Since given any input $f(x)$ which is always 0, any adversary has no knowledge about $x$, and thus the best way to guess $\oplus_i x_i$ is based on the statistical distribution of the predicate. However, it is a uniform distribution, and thus any adversary cannot have non-negligible advantage.

\end{document}
